[Unit]
Description=FourMore OSM Data Update
Documentation=https://github.com/mvexel/osm-fourmore/systemd
After=network-online.target docker.service
Wants=network-online.target
Requires=docker.service

[Service]
Type=oneshot
User=fourmore
Group=fourmore

# Set the working directory to your FourMore project
WorkingDirectory=/home/fourmore/osm-fourmore

# Load environment variables if you have a .env.local file
EnvironmentFile=-/home/fourmore/osm-fourmore/.env.local

# Run the update via make
ExecStart=/usr/bin/make db-update

# Logging
StandardOutput=journal
StandardError=journal
SyslogIdentifier=fourmore-osm-update

# Resource limits (optional)
# Prevent runaway updates from consuming all resources
MemoryMax=2G
CPUQuota=80%

# Restart policy
Restart=on-failure
RestartSec=5min

# Security hardening (optional)
NoNewPrivileges=true
PrivateTmp=true

[Install]
WantedBy=multi-user.target
